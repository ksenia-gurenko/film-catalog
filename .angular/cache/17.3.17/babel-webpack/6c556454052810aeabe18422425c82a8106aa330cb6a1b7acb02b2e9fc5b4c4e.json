{"ast":null,"code":"import { Subject } from 'rxjs';\nimport { takeUntil, finalize } from 'rxjs/operators';\nimport { API_CONFIG } from '../../utils/constants';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/movie.service\";\nimport * as i2 from \"@angular/router\";\nfunction MovieListComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵelement(1, \"div\", 11);\n    i0.ɵɵelementStart(2, \"p\");\n    i0.ɵɵtext(3, \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0436\\u0430\\u0435\\u043C \\u0444\\u0438\\u043B\\u044C\\u043C\\u044B...\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction MovieListComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"div\", 13)(2, \"h2\");\n    i0.ɵɵtext(3, \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function MovieListComponent_div_7_Template_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.loadMovies());\n    });\n    i0.ɵɵtext(7, \" \\u041F\\u043E\\u043F\\u0440\\u043E\\u0431\\u043E\\u0432\\u0430\\u0442\\u044C \\u0441\\u043D\\u043E\\u0432\\u0430 \");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.error);\n  }\n}\nfunction MovieListComponent_div_8_button_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function MovieListComponent_div_8_button_4_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.onSearch(\"\"));\n    });\n    i0.ɵɵtext(1, \" \\u041E\\u0447\\u0438\\u0441\\u0442\\u0438\\u0442\\u044C \\u043F\\u043E\\u0438\\u0441\\u043A \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction MovieListComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15)(1, \"div\", 16)(2, \"h2\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, MovieListComponent_div_8_button_4_Template, 2, 0, \"button\", 17);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r1.getEmptyStateMessage());\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.searchQuery);\n  }\n}\nfunction MovieListComponent_div_9_app_movie_card_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-movie-card\", 21);\n    i0.ɵɵlistener(\"cardClick\", function MovieListComponent_div_9_app_movie_card_1_Template_app_movie_card_cardClick_0_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.onMovieClick($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const movie_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"movie\", movie_r5)(\"showDetails\", false);\n  }\n}\nfunction MovieListComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 19);\n    i0.ɵɵtemplate(1, MovieListComponent_div_9_app_movie_card_1_Template, 1, 2, \"app-movie-card\", 20);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.filteredMovies)(\"ngForTrackBy\", ctx_r1.trackByMovieId);\n  }\n}\nfunction MovieListComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22)(1, \"p\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\\u041D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E \", ctx_r1.filteredMovies.length, \" \\u0444\\u0438\\u043B\\u044C\\u043C\\u043E\\u0432 \\u043F\\u043E \\u0437\\u0430\\u043F\\u0440\\u043E\\u0441\\u0443 \\\"\", ctx_r1.searchQuery, \"\\\"\");\n  }\n}\nexport let MovieListComponent = /*#__PURE__*/(() => {\n  class MovieListComponent {\n    movieService;\n    router;\n    cdr;\n    movies = [];\n    filteredMovies = [];\n    isLoading = true;\n    error = null;\n    searchQuery = '';\n    destroy$ = new Subject();\n    constructor(movieService, router, cdr) {\n      this.movieService = movieService;\n      this.router = router;\n      this.cdr = cdr;\n    }\n    ngOnInit() {\n      this.loadMovies();\n      this.setupSearch();\n    }\n    ngOnDestroy() {\n      this.destroy$.next();\n      this.destroy$.complete();\n    }\n    loadMovies() {\n      this.isLoading = true;\n      this.error = null;\n      this.movieService.getMovies({\n        _page: 1,\n        _limit: API_CONFIG.DEFAULT_PAGE_SIZE\n      }).pipe(takeUntil(this.destroy$), finalize(() => {\n        this.isLoading = false;\n        this.cdr.markForCheck();\n      })).subscribe({\n        next: response => {\n          this.movies = response.movies;\n          this.filteredMovies = [...this.movies];\n        },\n        error: error => {\n          this.error = error.message || 'Не удалось загрузить фильмы';\n          console.error('Error loading movies:', error);\n        }\n      });\n    }\n    setupSearch() {\n      this.movieService.search$.pipe(takeUntil(this.destroy$)).subscribe({\n        next: movies => {\n          this.filteredMovies = movies;\n          this.cdr.markForCheck();\n        },\n        error: error => {\n          console.error('Search error:', error);\n        }\n      });\n    }\n    onSearch(query) {\n      this.searchQuery = query;\n      this.movieService.setSearchQuery(query);\n    }\n    onMovieClick(movieId) {\n      this.router.navigate(['/movie', movieId]);\n    }\n    trackByMovieId(index, movie) {\n      return movie.id;\n    }\n    getEmptyStateMessage() {\n      if (this.searchQuery) {\n        return `По запросу \"${this.searchQuery}\" ничего не найдено`;\n      }\n      return 'Фильмы не найдены';\n    }\n    static ɵfac = function MovieListComponent_Factory(t) {\n      return new (t || MovieListComponent)(i0.ɵɵdirectiveInject(i1.MovieService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: MovieListComponent,\n      selectors: [[\"app-movie-list\"]],\n      decls: 11,\n      vars: 5,\n      consts: [[1, \"movie-list\"], [1, \"movie-list__header\"], [1, \"movie-list__title\"], [1, \"movie-list__search\", 3, \"search\"], [1, \"movie-list__content\"], [\"class\", \"movie-list__loading\", 4, \"ngIf\"], [\"class\", \"movie-list__error\", 4, \"ngIf\"], [\"class\", \"movie-list__empty\", 4, \"ngIf\"], [\"class\", \"movie-list__grid\", 4, \"ngIf\"], [\"class\", \"movie-list__results-info\", 4, \"ngIf\"], [1, \"movie-list__loading\"], [1, \"loading-spinner\"], [1, \"movie-list__error\"], [1, \"error-message\"], [\"aria-label\", \"\\u041F\\u043E\\u043F\\u0440\\u043E\\u0431\\u043E\\u0432\\u0430\\u0442\\u044C \\u0441\\u043D\\u043E\\u0432\\u0430\", 1, \"retry-button\", 3, \"click\"], [1, \"movie-list__empty\"], [1, \"empty-state\"], [\"class\", \"clear-search-button\", \"aria-label\", \"\\u041E\\u0447\\u0438\\u0441\\u0442\\u0438\\u0442\\u044C \\u043F\\u043E\\u0438\\u0441\\u043A\", 3, \"click\", 4, \"ngIf\"], [\"aria-label\", \"\\u041E\\u0447\\u0438\\u0441\\u0442\\u0438\\u0442\\u044C \\u043F\\u043E\\u0438\\u0441\\u043A\", 1, \"clear-search-button\", 3, \"click\"], [1, \"movie-list__grid\"], [\"class\", \"movie-list__card\", 3, \"movie\", \"showDetails\", \"cardClick\", 4, \"ngFor\", \"ngForOf\", \"ngForTrackBy\"], [1, \"movie-list__card\", 3, \"cardClick\", \"movie\", \"showDetails\"], [1, \"movie-list__results-info\"]],\n      template: function MovieListComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"header\", 1)(2, \"h1\", 2);\n          i0.ɵɵtext(3, \"\\u041A\\u0430\\u0442\\u0430\\u043B\\u043E\\u0433 \\u0444\\u0438\\u043B\\u044C\\u043C\\u043E\\u0432\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(4, \"app-search-bar\", 3);\n          i0.ɵɵlistener(\"search\", function MovieListComponent_Template_app_search_bar_search_4_listener($event) {\n            return ctx.onSearch($event);\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(5, \"main\", 4);\n          i0.ɵɵtemplate(6, MovieListComponent_div_6_Template, 4, 0, \"div\", 5)(7, MovieListComponent_div_7_Template, 8, 1, \"div\", 6)(8, MovieListComponent_div_8_Template, 5, 2, \"div\", 7)(9, MovieListComponent_div_9_Template, 2, 2, \"div\", 8)(10, MovieListComponent_div_10_Template, 3, 2, \"div\", 9);\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.error && !ctx.isLoading);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.isLoading && !ctx.error && ctx.filteredMovies.length === 0);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.isLoading && !ctx.error && ctx.filteredMovies.length > 0);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.searchQuery && ctx.filteredMovies.length > 0);\n        }\n      },\n      styles: [\".movie-list[_ngcontent-%COMP%]{padding:32px 0}.movie-list__header[_ngcontent-%COMP%]{margin-bottom:48px;text-align:center}.movie-list__title[_ngcontent-%COMP%]{font-size:32px;font-weight:300;color:#212121;margin-bottom:32px}@media (max-width: 480px){.movie-list__title[_ngcontent-%COMP%]{font-size:24px;margin-bottom:24px}}.movie-list__search[_ngcontent-%COMP%]{margin:0 auto}.movie-list__content[_ngcontent-%COMP%]{min-height:400px}.movie-list__loading[_ngcontent-%COMP%], .movie-list__error[_ngcontent-%COMP%], .movie-list__empty[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;min-height:400px;text-align:center}.movie-list__loading[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;color:#757575}.movie-list__error[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{max-width:400px;padding:32px;background:#fff;border-radius:12px;box-shadow:0 4px 8px #00000026;transition:box-shadow .3s ease}.movie-list__error[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]:hover{box-shadow:0 8px 16px #0003}.movie-list__error[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#f44336;margin-bottom:16px}.movie-list__error[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#757575;margin-bottom:24px}.movie-list__error[_ngcontent-%COMP%]   .retry-button[_ngcontent-%COMP%]{padding:16px 32px;background:#1976d2;color:#fff;border-radius:8px;font-weight:500;transition:background-color .2s ease}.movie-list__error[_ngcontent-%COMP%]   .retry-button[_ngcontent-%COMP%]:hover{background:#0d47a1}.movie-list__empty[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{max-width:400px;padding:32px;background:#fff;border-radius:12px;box-shadow:0 4px 8px #00000026;transition:box-shadow .3s ease}.movie-list__empty[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]:hover{box-shadow:0 8px 16px #0003}.movie-list__empty[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#757575;margin-bottom:24px;font-weight:400}.movie-list__empty[_ngcontent-%COMP%]   .clear-search-button[_ngcontent-%COMP%]{padding:16px 32px;background:transparent;color:#1976d2;border:2px solid #1976d2;border-radius:8px;font-weight:500;transition:all .2s ease}.movie-list__empty[_ngcontent-%COMP%]   .clear-search-button[_ngcontent-%COMP%]:hover{background:#1976d2;color:#fff}.movie-list__grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:32px;margin-bottom:48px}@media (max-width: 768px){.movie-list__grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:24px}}@media (max-width: 480px){.movie-list__grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}}.movie-list__card[_ngcontent-%COMP%]{height:100%}.movie-list__results-info[_ngcontent-%COMP%]{text-align:center;padding:24px;color:#757575;background:#fff;border-radius:12px;margin-top:32px}.movie-list__results-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}\"],\n      changeDetection: 0\n    });\n  }\n  return MovieListComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}